<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Send a Request</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: #f5f5f5;
            color: #333;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        h1 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 24px;
            text-align: center;
            color: #1a1a1a;
        }

        .back-btn {
            background: none;
            border: none;
            color: #4a90e2;
            font-size: 16px;
            cursor: pointer;
            margin-bottom: 16px;
            display: none;
            align-items: center;
            gap: 4px;
        }

        .back-btn.show {
            display: flex;
        }

        .button-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
            margin-bottom: 24px;
        }

        .request-btn {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 18px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 12px;
            text-align: left;
        }

        .request-btn:hover {
            border-color: #4a90e2;
            background: #f8fafc;
        }

        .request-btn:active {
            transform: scale(0.98);
        }

        .request-btn.selected {
            border-color: #4a90e2;
            background: #e3f2fd;
        }

        .emoji {
            font-size: 24px;
            min-width: 24px;
        }

        .category-view,
        .detailed-view {
            display: none;
        }

        .category-view.active,
        .detailed-view.active {
            display: block;
        }

        .detailed-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }

        .detailed-item {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 14px;
            font-size: 15px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
        }

        .detailed-item:hover {
            border-color: #4a90e2;
            background: #f8fafc;
        }

        .detailed-item.selected {
            border-color: #4a90e2;
            background: #e3f2fd;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 8px;
            color: #555;
        }

        input[type="text"],
        textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            font-family: inherit;
            transition: border-color 0.2s;
        }

        input[type="text"]:focus,
        textarea:focus {
            outline: none;
            border-color: #4a90e2;
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        .submit-btn {
            width: 100%;
            background: #4a90e2;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 16px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
        }

        .submit-btn:hover {
            background: #3a7bc8;
        }

        .submit-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .progress-btn {
            width: 100%;
            background: #ff9800;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 16px;
            font-size: 16px;
            font-weight: 600;
            margin-top: 12px;
            display: none;
        }

        .progress-btn.show {
            display: block;
        }

        .status-message {
            margin-top: 16px;
            padding: 12px;
            border-radius: 8px;
            font-size: 14px;
            text-align: center;
            display: none;
        }

        .status-message.sending {
            display: block;
            background: #fff3cd;
            color: #856404;
        }

        .status-message.success {
            display: block;
            background: #d4edda;
            color: #155724;
        }

        .status-message.error {
            display: block;
            background: #f8d7da;
            color: #721c24;
        }

        @media (min-width: 600px) {
            .button-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <button class="back-btn" id="backBtn">‚Üê Back</button>
        <h1 id="pageTitle">Send a Request</h1>
        
        <form id="requestForm">
            <div class="form-group">
                <label for="roomNumber">Room Number *</label>
                <input type="text" id="roomNumber" name="roomNumber" required placeholder="Enter your room number">
            </div>

            <div class="category-view active" id="categoryView">
                <div class="button-grid">
                    <button type="button" class="request-btn" data-category="housekeeping">
                        <span class="emoji">üßπ</span>
                        <span>Housekeeping</span>
                    </button>
                    <button type="button" class="request-btn" data-category="maintenance">
                        <span class="emoji">üõ†</span>
                        <span>Maintenance</span>
                    </button>
                    <button type="button" class="request-btn" data-category="reception">
                        <span class="emoji">‚òé</span>
                        <span>Reception</span>
                    </button>
                </div>
            </div>

            <div class="detailed-view" id="detailedView">
                <div class="detailed-list" id="detailedList"></div>
            </div>

            <div class="form-group">
                <label for="feedback">Feedback (Optional)</label>
                <textarea id="feedback" name="feedback" placeholder="Add any additional comments..."></textarea>
            </div>

            <button type="submit" class="submit-btn" id="submitBtn">Send Request</button>
            <button type="button" class="progress-btn" id="progressBtn">Request in Progress</button>

            <div class="status-message" id="statusMessage"></div>
        </form>
    </div>

    <script>
        const form = document.getElementById('requestForm');
        const roomNumberInput = document.getElementById('roomNumber');
        const feedbackArea = document.getElementById('feedback');
        const submitBtn = document.getElementById('submitBtn');
        const progressBtn = document.getElementById('progressBtn');
        const statusMessage = document.getElementById('statusMessage');
        const categoryView = document.getElementById('categoryView');
        const detailedView = document.getElementById('detailedView');
        const detailedList = document.getElementById('detailedList');
        const backBtn = document.getElementById('backBtn');
        const pageTitle = document.getElementById('pageTitle');
        const categoryBtns = document.querySelectorAll('[data-category]');

        const WEBHOOK_URL = 'https://efdemo.app.n8n.cloud/webhook-test/REPLACE_WITH_REAL_ID';
        const HOTEL_ID = 'H001';
        const LANGUAGE = 'en';

        let selectedRequest = '';
        let currentCategory = '';

        const requests = {
            housekeeping: [
                "Please send extra towels to the room",
                "Can we get two extra pillows",
                "Need fresh bedsheets",
                "Request room cleaning now",
                "Please refill coffee and tea supplies",
                "Can we get extra toilet paper",
                "Need additional hangers in the closet",
                "Please replace used towels",
                "Request evening turndown service",
                "Can you empty the trash bin",
                "Need a fresh bath mat",
                "Please bring extra blankets",
                "Room hasn't been cleaned today",
                "Request pillow change (firm/soft)",
                "Need baby crib bedding",
                "Please sanitize the room",
                "Request room cleaning before 10 AM",
                "Need laundry pickup",
                "Please refill minibar water",
                "Need extra slippers",
                "Request ironing service",
                "Please bring extra glasses",
                "Room smells, needs refresh",
                "Request towel replacement immediately",
                "Need extra sheets for sofa bed",
                "Please clean balcony area",
                "Need extra trash bags",
                "Request duvet change",
                "Can you restock bathroom amenities",
                "Please prepare room for early sleep"
            ],
            maintenance: [
                "Air conditioner is not cooling",
                "TV remote not working",
                "Toilet is clogged",
                "Shower drain is blocked",
                "Hot water not working",
                "Light bulb is burnt out",
                "Safe box is not opening",
                "Wi-Fi signal is weak in room",
                "Door lock not working properly",
                "Window won't close",
                "Mini fridge not cooling",
                "Electrical outlet not working",
                "Bathroom sink leaking",
                "AC making loud noise",
                "TV has no signal",
                "Shower pressure is very low",
                "Bedside lamp not turning on",
                "Toilet keeps running water",
                "Balcony door stuck",
                "Air conditioner leaking water",
                "Curtains rail is broken",
                "Smoke detector beeping",
                "Room key card not working",
                "Thermostat not responding",
                "Bathroom fan not working",
                "Broken chair in room",
                "Faucet handle loose",
                "Power keeps cutting in room",
                "Strange smell from AC",
                "Phone in room not working"
            ],
            reception: [
                "Request wake-up call at 7 AM",
                "Can I check out late",
                "Need taxi booking",
                "Request room upgrade",
                "What time is breakfast",
                "Need Wi-Fi password",
                "Can you print documents",
                "Request invoice copy",
                "Need city map",
                "Can you book a restaurant",
                "Request luggage assistance",
                "Early check-in request",
                "Need directions to airport",
                "Can I extend my stay",
                "Request bill clarification",
                "Need extra room key",
                "Request housekeeping schedule info",
                "Can I change room",
                "Request shuttle service",
                "Need tour information",
                "Ask about spa availability",
                "Request lost-and-found check",
                "Need medical assistance info",
                "Can you store luggage",
                "Request quiet room",
                "Ask about gym hours",
                "Need exchange rate info",
                "Request birthday arrangement",
                "Can you call my room",
                "Need help with payment issue"
            ]
        };

        categoryBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                currentCategory = this.dataset.category;
                showDetailedView(currentCategory);
            });
        });

        backBtn.addEventListener('click', function() {
            showCategoryView();
        });

        function showDetailedView(category) {
            categoryView.classList.remove('active');
            detailedView.classList.add('active');
            backBtn.classList.add('show');
            
            const categoryTitles = {
                housekeeping: 'Housekeeping Requests',
                maintenance: 'Maintenance Requests',
                reception: 'Reception / Front Desk Requests'
            };
            pageTitle.textContent = categoryTitles[category];

            detailedList.innerHTML = '';
            requests[category].forEach(request => {
                const item = document.createElement('button');
                item.type = 'button';
                item.className = 'detailed-item';
                item.textContent = request;
                item.addEventListener('click', function() {
                    document.querySelectorAll('.detailed-item').forEach(i => i.classList.remove('selected'));
                    this.classList.add('selected');
                    selectedRequest = request;
                });
                detailedList.appendChild(item);
            });
        }

        function showCategoryView() {
            detailedView.classList.remove('active');
            categoryView.classList.add('active');
            backBtn.classList.remove('show');
            pageTitle.textContent = 'Send a Request';
            selectedRequest = '';
            document.querySelectorAll('.detailed-item').forEach(i => i.classList.remove('selected'));
        }

        form.addEventListener('submit', async function(e) {
            e.preventDefault();

            const roomNumber = roomNumberInput.value.trim();
            const feedback = feedbackArea.value.trim();

            if (!roomNumber) {
                showStatus('Please enter your room number', 'error');
                return;
            }

            if (!selectedRequest) {
                showStatus('Please select a request', 'error');
                return;
            }

            let requestText = selectedRequest;
            if (feedback) {
                requestText += ' - Feedback: ' + feedback;
            }

            const payload = {
                hotel_id: HOTEL_ID,
                room_number: roomNumber,
                language: LANGUAGE,
                request_text: requestText
            };

            try {
                submitBtn.disabled = true;
                showStatus('Sending...', 'sending');

                const response = await fetch(WEBHOOK_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                });

                if (response.ok) {
                    showStatus('Request sent successfully', 'success');
                    progressBtn.classList.add('show');
                    submitBtn.style.display = 'none';
                    feedbackArea.value = '';
                    selectedRequest = '';
                    document.querySelectorAll('.detailed-item').forEach(i => i.classList.remove('selected'));
                } else {
                    showStatus('Failed to send request. Please try again.', 'error');
                }
            } catch (error) {
                showStatus('Network error. Please check your connection and try again.', 'error');
            } finally {
                submitBtn.disabled = false;
            }
        });

        function showStatus(message, type) {
            statusMessage.textContent = message;
            statusMessage.className = 'status-message ' + type;

            if (type === 'success' || type === 'error') {
                setTimeout(() => {
                    statusMessage.className = 'status-message';
                }, 5000);
            }
        }
    </script>
</body>
</html>
